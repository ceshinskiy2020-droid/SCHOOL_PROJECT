{% extends "base.html" %}

{% block title %}Текущая сессия{% endblock %}

{% block extra_css %}
<style>
    .session-status {
        font-size: 14px;
        padding: 4px 12px;
        background-color: #000000;
        color: #ffffff;
        display: inline-block;
        margin-bottom: 20px;
    }
    
    .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
        margin: 30px 0;
    }
    
    .info-item {
        border: 1px solid #000000;
        padding: 20px;
    }
    
    .info-label {
        font-size: 12px;
        color: #666666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 5px;
    }
    
    .info-value {
        font-size: 18px;
        font-weight: 600;
    }
    
    .timer {
        font-size: 48px;
        font-weight: 700;
        text-align: center;
        margin: 30px 0;
        font-family: 'Courier New', monospace;
    }
    
    @media (max-width: 768px) {
        .info-grid {
            grid-template-columns: 1fr;
        }
        
        .timer {
            font-size: 36px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="text-center mb-4">
    <div class="session-status">АКТИВНАЯ СЕССИЯ</div>
    <h1 style="font-size: 24px; font-weight: 600;">ТЕКУЩАЯ СЕССИЯ</h1>
</div>

<div class="card">
    <div class="info-grid">
        <div class="info-item">
            <div class="info-label">Рабочее место</div>
            <div class="info-value">{{ session_data[1] }}</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Начало сессии</div>
            <div class="info-value">{{ session_data[2][:16].replace('T', ' ') }}</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Пользователь</div>
            <div class="info-value">{{ session_data[3] }} {{ session_data[4] }}</div>
        </div>
        
        <div class="info-item">
            <div class="info-label">Класс</div>
            <div class="info-value">{{ session_data[5] }}</div>
        </div>
    </div>
    
    <div class="timer" id="timer">00:00:00</div>
    
    <div class="text-center">
        <a href="{{ url_for('end_session') }}" 
           class="btn btn-danger" 
           style="padding: 15px 40px; font-size: 16px;"
           onclick="return confirm('Завершить текущую сессию?')">
            ЗАВЕРШИТЬ СЕССИЮ
        </a>
    </div>
</div>

<div class="text-center mt-3">
    <a href="{{ url_for('select_button') }}" class="btn">Вернуться к выбору места</a>
</div>

<script>
    // Таймер длительности сессии
    function updateTimer() {
        const startTime = new Date("{{ session_data[2] }}");
        const now = new Date();
        const diffMs = now - startTime;
        
        const hours = Math.floor(diffMs / 3600000);
        const minutes = Math.floor((diffMs % 3600000) / 60000);
        const seconds = Math.floor((diffMs % 60000) / 1000);
        
        document.getElementById('timer').textContent = 
            `${hours.toString().padStart(2, '0')}:` +
            `${minutes.toString().padStart(2, '0')}:` +
            `${seconds.toString().padStart(2, '0')}`;
    }
    
    // Обновляем таймер каждую секунду
    updateTimer();
    setInterval(updateTimer, 1000);
</script>
{% endblock %}
